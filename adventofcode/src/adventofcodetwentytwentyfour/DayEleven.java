package adventofcodetwentytwentyfour;

import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintStream;
import java.util.ArrayList;
import java.util.List;

import utils.Util;

public class DayEleven {
    public static void main(String[] args) {
        List<Long> stones = new ArrayList<>();
        long[] input = {41078, 18, 7, 0, 4785508, 535256, 8154, 447};
        long[][] precompute = {{1,1,2,4,4,7,14,16,20,39,62,81,110,200,328,418,667,1059,1546,2377,3572,5602,8268,12343,19778,29165,43726,67724,102131,156451,234511,357632,549949,819967,1258125,1916299,2886408,4414216,6669768,10174278},{1,2,4,4,7,14,16,20,39,62,81,110,200,328,418,667,1059,1546,2377,3572,5602,8268,12343,19778,29165,43726,67724,102131,156451,234511,357632,549949,819967,1258125,1916299,2886408,4414216,6669768,10174278,15458147},{1,2,4,4,6,12,16,19,30,57,92,111,181,295,414,661,977,1501,2270,3381,5463,7921,11819,18712,27842,42646,64275,97328,150678,223730,343711,525238,784952,1208065,1824910,2774273,4230422,6365293,9763578,14777945},{1,2,4,4,5,10,16,26,35,52,79,114,202,294,401,642,987,1556,2281,3347,5360,7914,12116,18714,27569,42628,64379,98160,150493,223231,344595,524150,788590,1210782,1821382,2779243,4230598,6382031,9778305,14761601},{1,2,4,4,4,8,16,27,30,47,82,115,195,269,390,637,951,1541,2182,3204,5280,7721,11820,17957,26669,41994,62235,95252,146462,216056,336192,508191,766555,1178119,1761823,2709433,4110895,6188994,9515384,14316637},{1,1,2,4,8,8,11,22,32,45,67,109,163,223,383,597,808,1260,1976,3053,4529,6675,10627,15847,23822,37090,55161,84208,128121,194545,298191,444839,681805,1042629,1565585,2396146,3626619,5509999,8396834,12678459},{1,1,2,4,8,8,11,22,32,54,68,103,183,250,401,600,871,1431,2033,3193,4917,7052,11371,16815,25469,39648,57976,90871,136703,205157,319620,473117,727905,1110359,1661899,2567855,3849988,5866379,8978479,13464170},{1,1,2,4,8,8,11,22,32,52,72,106,168,242,413,602,832,1369,2065,3165,4762,6994,11170,16509,25071,39034,57254,88672,134638,203252,312940,465395,716437,1092207,1637097,2519878,3794783,5771904,8814021,13273744},{1,1,2,4,7,7,11,22,31,48,69,103,161,239,393,578,812,1322,2011,3034,4580,6798,10738,16018,24212,37525,55534,85483,130183,196389,301170,450896,691214,1054217,1583522,2428413,3669747,5573490,8505207,12835708},{1,1,2,4,8,8,11,22,32,54,70,103,183,262,419,586,854,1468,2131,3216,4888,7217,11617,17059,25793,40124,58820,92114,139174,208558,322818,480178,740365,1126352,1685448,2602817,3910494,5953715,9102530,13675794},{2,2,3,6,8,11,21,30,36,59,101,143,191,310,528,746,1085,1726,2605,3923,5949,9174,13870,20611,32121,48943,72891,111450,169855,258582,390962,592143,907581,1369916,2078092,3174424,4802707,7300624,11083984,16844046},{2,2,4,8,8,14,28,32,40,78,124,162,220,400,656,836,1334,2118,3092,4754,7144,11204,16536,24686,39556,58330,87452,135448,204262,312902,469022,715264,1099898,1639934,2516250,3832598,5772816,8828432,13339536,20348556},{2,2,4,8,8,13,26,32,39,69,119,173,221,381,623,832,1328,2036,3047,4647,6953,11065,16189,24162,38490,57007,86372,131999,199459,307129,458241,701343,1075187,1604919,2466190,3741209,5660681,8644638,13035061,19937856},{2,2,4,8,8,12,24,32,46,74,114,160,224,402,622,819,1309,2046,3102,4658,6919,10962,16182,24459,38492,56734,86354,132103,200291,306944,457742,702227,1074099,1608557,2468907,3737681,5665651,8644814,13051799,19952583},{2,2,4,8,8,11,22,32,47,69,109,163,225,395,597,808,1304,2010,3087,4559,6776,10882,15989,24163,37735,55834,85720,129959,197383,302913,450567,693824,1058140,1586522,2436244,3678122,5595841,8525111,12858762,19689662},{2,2,3,6,8,15,22,27,42,71,107,148,219,363,551,801,1264,1867,2806,4353,6625,10131,14943,22970,35625,52987,80816,122885,186339,284572,429056,655823,994788,1501772,2300754,3481884,5282554,8040835,12179767,18571112},{2,2,3,6,8,15,22,27,42,71,116,149,213,383,578,819,1267,1930,2977,4410,6765,10519,15320,23714,36593,54634,83374,125700,193002,293154,439668,677252,1023066,1547872,2368484,3578198,5454263,8264204,12536147,19152757},{2,2,3,6,8,15,22,27,42,71,114,153,216,368,570,831,1269,1891,2915,4442,6737,10364,15262,23513,36287,54236,82760,124978,190803,291089,437763,670572,1015344,1536404,2350332,3553396,5406286,8208999,12441672,18988299},{2,2,3,6,8,14,21,27,42,70,110,150,213,361,567,811,1245,1871,2868,4388,6606,10182,15066,23081,35796,53377,81251,123258,187614,286634,430900,658802,1000845,1511181,2312342,3499821,5314821,8083963,12243258,18679485},{2,2,3,6,8,15,22,27,42,71,116,151,213,383,590,837,1253,1913,3014,4508,6788,10490,15485,23960,36837,54958,83850,126544,194245,295625,443069,680450,1030127,1560332,2384477,3601747,5489225,8324710,12623483,19276808},{2,2,3,6,8,10,19,30,35,50,96,154,192,291,495,742,1079,1644,2560,3816,5758,9035,13523,20087,31055,47620,71811,108001,165052,252809,380181,578222,882870,1334901,2028032,3083035,4690572,7116830,10779509,16433346},{2,2,4,8,8,13,26,32,39,69,119,173,221,381,623,832,1328,2036,3047,4647,6953,11065,16189,24162,38490,57007,86372,131999,199459,307129,458241,701343,1075187,1604919,2466190,3741209,5660681,8644638,13035061,19937856},{2,2,4,8,8,12,24,32,38,60,114,184,222,362,590,828,1322,1954,3002,4540,6762,10926,15842,23638,37424,55684,85292,128550,194656,301356,447460,687422,1050476,1569904,2416130,3649820,5548546,8460844,12730586,19527156},{2,2,4,8,8,11,22,32,45,65,109,171,225,383,589,815,1303,1964,3057,4551,6728,10823,15835,23935,37426,55411,85274,128654,195488,301171,446961,688306,1049388,1573542,2418847,3646292,5553516,8461020,12747324,19541883},{2,2,4,8,8,10,20,32,46,60,104,174,226,376,564,804,1298,1928,3042,4452,6585,10743,15642,23639,36669,54511,84640,126510,192580,297140,439786,679903,1033429,1551507,2386184,3586733,5483706,8341317,12554287,19278962},{2,2,3,6,8,14,20,27,41,62,102,159,220,344,518,797,1258,1785,2761,4246,6434,9992,14596,22446,34559,51664,79736,119436,181536,278799,418275,641902,970077,1466757,2250694,3390495,5170419,7857041,11875292,18160412},{2,2,3,6,8,14,20,27,41,62,111,160,214,364,545,815,1261,1848,2932,4303,6574,10380,14973,23190,35527,53311,82294,122251,188199,287381,428887,663331,998355,1512857,2318424,3486809,5342128,8080410,12231672,18742057},{2,2,3,6,8,14,20,27,41,62,109,164,217,349,537,827,1263,1809,2870,4335,6546,10225,14915,22989,35221,52913,81680,121529,186000,285316,426982,656651,990633,1501389,2300272,3462007,5294151,8025205,12137197,18577599},{2,2,3,6,8,13,19,27,41,61,105,161,214,342,534,807,1239,1789,2823,4281,6415,10043,14719,22557,34730,52054,80171,119809,182811,280861,420119,644881,976134,1476166,2262282,3408432,5202686,7900169,11938783,18268785},{2,2,3,6,8,14,20,27,41,62,111,162,214,364,557,833,1247,1831,2969,4401,6597,10351,15138,23436,35771,53635,82770,123095,189442,289852,432288,666529,1005416,1525317,2334417,3510358,5377090,8140916,12319008,18866108},{2,2,3,6,8,9,17,30,42,55,91,141,195,312,494,729,1060,1654,2615,3827,5724,8932,13516,20384,31057,47347,71793,108105,165884,252624,379682,579106,881782,1338539,2030749,3079507,4695542,7117006,10796247,16448073},{2,2,4,8,8,12,24,32,46,74,114,160,224,402,622,819,1309,2046,3102,4658,6919,10962,16182,24459,38492,56734,86354,132103,200291,306944,457742,702227,1074099,1608557,2468907,3737681,5665651,8644814,13051799,19952583},{2,2,4,8,8,11,22,32,45,65,109,171,225,383,589,815,1303,1964,3057,4551,6728,10823,15835,23935,37426,55411,85274,128654,195488,301171,446961,688306,1049388,1573542,2418847,3646292,5553516,8461020,12747324,19541883},{2,2,4,8,8,10,20,32,52,70,104,158,228,404,588,802,1284,1974,3112,4562,6694,10720,15828,24232,37428,55138,85256,128758,196320,300986,446462,689190,1048300,1577180,2421564,3642764,5558486,8461196,12764062,19556610},{2,2,4,8,8,9,18,32,53,65,99,161,229,397,563,791,1279,1938,3097,4463,6551,10640,15635,23936,36671,54238,84622,126614,193412,296955,439287,680787,1032341,1555145,2388901,3583205,5488676,8341493,12571025,19293689},{2,2,3,6,8,13,18,27,48,67,97,146,223,365,517,784,1239,1795,2816,4257,6400,9889,14589,22743,34561,51391,79718,119540,182368,278614,417776,642786,968989,1470395,2253411,3386967,5175389,7857217,11892030,18175139},{2,2,3,6,8,13,18,27,48,67,106,147,217,385,544,802,1242,1858,2987,4314,6540,10277,14966,23487,35529,53038,82276,122355,189031,287196,428388,664215,997267,1516495,2321141,3483281,5347098,8080586,12248410,18756784},{2,2,3,6,8,13,18,27,48,67,104,151,220,370,536,814,1244,1819,2925,4346,6512,10122,14908,23286,35223,52640,81662,121633,186832,285131,426483,657535,989545,1505027,2302989,3458479,5299121,8025381,12153935,18592326},{2,2,3,6,8,12,17,27,48,66,100,148,217,363,533,794,1220,1799,2878,4292,6381,9940,14712,22854,34732,51781,80153,119913,183643,280676,419620,645765,975046,1479804,2264999,3404904,5207656,7900345,11955521,18283512},{2,2,3,6,8,13,18,27,48,67,106,149,217,385,556,820,1228,1841,3024,4412,6563,10248,15131,23733,35773,53362,82752,123199,190274,289667,431789,667413,1004328,1528955,2337134,3506830,5382060,8141092,12335746,18880835},{2,2,3,6,8,8,15,30,43,50,86,144,196,305,469,718,1055,1618,2600,3728,5581,8852,13323,20088,30300,46447,71159,105961,162976,248593,372507,570703,865823,1316504,1998086,3019948,4625732,6997303,10603210,16185152},{2,2,4,8,8,11,22,32,47,69,109,163,225,395,597,808,1304,2010,3087,4559,6776,10882,15989,24163,37735,55834,85720,129959,197383,302913,450567,693824,1058140,1586522,2436244,3678122,5595841,8525111,12858762,19689662},{2,2,4,8,8,10,20,32,46,60,104,174,226,376,564,804,1298,1928,3042,4452,6585,10743,15642,23639,36669,54511,84640,126510,192580,297140,439786,679903,1033429,1551507,2386184,3586733,5483706,8341317,12554287,19278962},{2,2,4,8,8,9,18,32,53,65,99,161,229,397,563,791,1279,1938,3097,4463,6551,10640,15635,23936,36671,54238,84622,126614,193412,296955,439287,680787,1032341,1555145,2388901,3583205,5488676,8341493,12571025,19293689},{2,2,4,8,8,8,16,32,54,60,94,164,230,390,538,780,1274,1902,3082,4364,6408,10560,15442,23640,35914,53338,83988,124470,190504,292924,432112,672384,1016382,1533110,2356238,3523646,5418866,8221790,12377988,19030768},{2,2,3,6,8,12,16,27,49,62,92,149,224,358,492,773,1234,1759,2801,4158,6257,9809,14396,22447,33804,50491,79084,117396,179460,274583,410601,634383,953030,1448360,2220748,3327408,5105579,7737514,11698993,17912218},{2,2,3,6,8,12,16,27,49,62,101,150,218,378,519,791,1237,1822,2972,4215,6397,10197,14773,23191,34772,52138,81642,120211,186123,283165,421213,655812,981308,1494460,2288478,3423722,5277288,7960883,12055373,18493863},{2,2,3,6,8,12,16,27,49,62,99,154,221,363,511,803,1239,1783,2910,4247,6369,10042,14715,22990,34466,51740,81028,119489,183924,281100,419308,649132,973586,1482992,2270326,3398920,5229311,7905678,11960898,18329405},{2,2,3,6,8,11,15,27,49,61,95,151,218,356,508,783,1215,1763,2863,4193,6238,9860,14519,22558,33975,50881,79519,117769,180735,276645,412445,637362,959087,1457769,2232336,3345345,5137846,7780642,11762484,18020591},{2,2,3,6,8,12,16,27,49,62,101,152,218,378,531,809,1223,1805,3009,4313,6420,10168,14938,23437,35016,52462,82118,121055,187366,285636,424614,659010,988369,1506920,2304471,3447271,5312250,8021389,12142709,18617914},{2,2,2,4,8,12,15,25,38,52,84,129,190,273,423,711,1015,1475,2319,3522,5430,8101,12277,18895,28190,43600,66255,98887,151932,230252,350996,532702,802471,1231754,1862596,2823710,4312445,6513027,9924215,15066602},{2,2,3,6,8,15,22,27,42,71,107,148,219,363,551,801,1264,1867,2806,4353,6625,10131,14943,22970,35625,52987,80816,122885,186339,284572,429056,655823,994788,1501772,2300754,3481884,5282554,8040835,12179767,18571112},{2,2,3,6,8,14,20,27,41,62,102,159,220,344,518,797,1258,1785,2761,4246,6434,9992,14596,22446,34559,51664,79736,119436,181536,278799,418275,641902,970077,1466757,2250694,3390495,5170419,7857041,11875292,18160412},{2,2,3,6,8,13,18,27,48,67,97,146,223,365,517,784,1239,1795,2816,4257,6400,9889,14589,22743,34561,51391,79718,119540,182368,278614,417776,642786,968989,1470395,2253411,3386967,5175389,7857217,11892030,18175139},{2,2,3,6,8,12,16,27,49,62,92,149,224,358,492,773,1234,1759,2801,4158,6257,9809,14396,22447,33804,50491,79084,117396,179460,274583,410601,634383,953030,1448360,2220748,3327408,5105579,7737514,11698993,17912218},{2,2,2,4,8,16,16,22,44,64,90,134,218,326,446,766,1194,1616,2520,3952,6106,9058,13350,21254,31694,47644,74180,110322,168416,256242,389090,596382,889678,1363610,2085258,3131170,4792292,7253238,11019998,16793668},{2,2,2,4,8,16,16,22,44,64,99,135,212,346,473,784,1197,1679,2691,4009,6246,9446,13727,21998,32662,49291,76738,113137,175079,264824,399702,617811,917956,1409710,2152988,3227484,4964001,7476607,11376378,17375313},{2,2,2,4,8,16,16,22,44,64,97,139,215,331,465,796,1199,1640,2629,4041,6218,9291,13669,21797,32356,48893,76124,112415,172880,262759,397797,611131,910234,1398242,2134836,3202682,4916024,7421402,11281903,17210855},{2,2,2,4,8,15,15,22,44,63,93,136,212,324,462,776,1175,1620,2582,3987,6087,9109,13473,21365,31865,48034,74615,110695,169691,258304,390934,599361,895735,1373019,2096846,3149107,4824559,7296366,11083489,16902041},{2,2,2,4,8,16,16,22,44,64,99,137,212,346,485,802,1183,1662,2728,4107,6269,9417,13892,22244,32906,49615,77214,113981,176322,267295,403103,621009,925017,1422170,2168981,3251033,4998963,7537113,11463714,17499364},{2,2,2,4,8,12,15,25,38,52,93,130,184,293,450,729,1018,1538,2490,3579,5570,8489,12654,19639,29158,45247,68813,101702,158595,238834,361608,554131,830749,1277854,1930326,2920024,4484154,6736396,10280595,15648247},{2,2,3,6,8,15,22,27,42,71,116,149,213,383,578,819,1267,1930,2977,4410,6765,10519,15320,23714,36593,54634,83374,125700,193002,293154,439668,677252,1023066,1547872,2368484,3578198,5454263,8264204,12536147,19152757},{2,2,3,6,8,14,20,27,41,62,111,160,214,364,545,815,1261,1848,2932,4303,6574,10380,14973,23190,35527,53311,82294,122251,188199,287381,428887,663331,998355,1512857,2318424,3486809,5342128,8080410,12231672,18742057},{2,2,3,6,8,13,18,27,48,67,106,147,217,385,544,802,1242,1858,2987,4314,6540,10277,14966,23487,35529,53038,82276,122355,189031,287196,428388,664215,997267,1516495,2321141,3483281,5347098,8080586,12248410,18756784},{2,2,3,6,8,12,16,27,49,62,101,150,218,378,519,791,1237,1822,2972,4215,6397,10197,14773,23191,34772,52138,81642,120211,186123,283165,421213,655812,981308,1494460,2288478,3423722,5277288,7960883,12055373,18493863},{2,2,2,4,8,16,16,22,44,64,99,135,212,346,473,784,1197,1679,2691,4009,6246,9446,13727,21998,32662,49291,76738,113137,175079,264824,399702,617811,917956,1409710,2152988,3227484,4964001,7476607,11376378,17375313},{2,2,2,4,8,16,16,22,44,64,108,136,206,366,500,802,1200,1742,2862,4066,6386,9834,14104,22742,33630,50938,79296,115952,181742,273406,410314,639240,946234,1455810,2220718,3323798,5135710,7699976,11732758,17956958},{2,2,2,4,8,16,16,22,44,64,106,140,209,351,492,814,1202,1703,2800,4098,6358,9679,14046,22541,33324,50540,78682,115230,179543,271341,408409,632560,938512,1444342,2202566,3298996,5087733,7644771,11638283,17792500},{2,2,2,4,8,15,15,22,44,63,102,137,206,344,489,794,1178,1683,2753,4044,6227,9497,13850,22109,32833,49681,77173,113510,176354,266886,401546,620790,924013,1419119,2164576,3245421,4996268,7519735,11439869,17483686},{2,2,2,4,8,16,16,22,44,64,108,138,206,366,512,820,1186,1725,2899,4164,6409,9805,14269,22988,33874,51262,79772,116796,182985,275877,413715,642438,953295,1468270,2236711,3347347,5170672,7760482,11820094,18081009},{2,2,2,4,8,12,15,25,38,52,91,134,187,278,442,741,1020,1499,2428,3611,5542,8334,12596,19438,28852,44849,68199,100980,156396,236769,359703,547451,823027,1266386,1912174,2895222,4436177,6681191,10186120,15483789},{2,2,3,6,8,15,22,27,42,71,114,153,216,368,570,831,1269,1891,2915,4442,6737,10364,15262,23513,36287,54236,82760,124978,190803,291089,437763,670572,1015344,1536404,2350332,3553396,5406286,8208999,12441672,18988299},{2,2,3,6,8,14,20,27,41,62,109,164,217,349,537,827,1263,1809,2870,4335,6546,10225,14915,22989,35221,52913,81680,121529,186000,285316,426982,656651,990633,1501389,2300272,3462007,5294151,8025205,12137197,18577599},{2,2,3,6,8,13,18,27,48,67,104,151,220,370,536,814,1244,1819,2925,4346,6512,10122,14908,23286,35223,52640,81662,121633,186832,285131,426483,657535,989545,1505027,2302989,3458479,5299121,8025381,12153935,18592326},{2,2,3,6,8,12,16,27,49,62,99,154,221,363,511,803,1239,1783,2910,4247,6369,10042,14715,22990,34466,51740,81028,119489,183924,281100,419308,649132,973586,1482992,2270326,3398920,5229311,7905678,11960898,18329405},{2,2,2,4,8,16,16,22,44,64,97,139,215,331,465,796,1199,1640,2629,4041,6218,9291,13669,21797,32356,48893,76124,112415,172880,262759,397797,611131,910234,1398242,2134836,3202682,4916024,7421402,11281903,17210855},{2,2,2,4,8,16,16,22,44,64,106,140,209,351,492,814,1202,1703,2800,4098,6358,9679,14046,22541,33324,50540,78682,115230,179543,271341,408409,632560,938512,1444342,2202566,3298996,5087733,7644771,11638283,17792500},{2,2,2,4,8,16,16,22,44,64,104,144,212,336,484,826,1204,1664,2738,4130,6330,9524,13988,22340,33018,50142,78068,114508,177344,269276,406504,625880,930790,1432874,2184414,3274194,5039756,7589566,11543808,17628042},{2,2,2,4,8,15,15,22,44,63,100,141,209,329,481,806,1180,1644,2691,4076,6199,9342,13792,21908,32527,49283,76559,112788,174155,264821,399641,614110,916291,1407651,2146424,3220619,4948291,7464530,11345394,17319228},{2,2,2,4,8,16,16,22,44,64,106,142,209,351,504,832,1188,1686,2837,4196,6381,9650,14211,22787,33568,50864,79158,116074,180786,273812,411810,635758,945573,1456802,2218559,3322545,5122695,7705277,11725619,17916551},{2,2,2,4,8,11,14,25,38,51,87,131,184,271,439,721,996,1479,2381,3557,5411,8152,12400,19006,28361,43990,66690,99260,153207,232314,352840,535681,808528,1241163,1874184,2841647,4344712,6556155,9987706,15174975},{2,2,3,6,8,14,21,27,42,70,110,150,213,361,567,811,1245,1871,2868,4388,6606,10182,15066,23081,35796,53377,81251,123258,187614,286634,430900,658802,1000845,1511181,2312342,3499821,5314821,8083963,12243258,18679485},{2,2,3,6,8,13,19,27,41,61,105,161,214,342,534,807,1239,1789,2823,4281,6415,10043,14719,22557,34730,52054,80171,119809,182811,280861,420119,644881,976134,1476166,2262282,3408432,5202686,7900169,11938783,18268785},{2,2,3,6,8,12,17,27,48,66,100,148,217,363,533,794,1220,1799,2878,4292,6381,9940,14712,22854,34732,51781,80153,119913,183643,280676,419620,645765,975046,1479804,2264999,3404904,5207656,7900345,11955521,18283512},{2,2,3,6,8,11,15,27,49,61,95,151,218,356,508,783,1215,1763,2863,4193,6238,9860,14519,22558,33975,50881,79519,117769,180735,276645,412445,637362,959087,1457769,2232336,3345345,5137846,7780642,11762484,18020591},{2,2,2,4,8,15,15,22,44,63,93,136,212,324,462,776,1175,1620,2582,3987,6087,9109,13473,21365,31865,48034,74615,110695,169691,258304,390934,599361,895735,1373019,2096846,3149107,4824559,7296366,11083489,16902041},{2,2,2,4,8,15,15,22,44,63,102,137,206,344,489,794,1178,1683,2753,4044,6227,9497,13850,22109,32833,49681,77173,113510,176354,266886,401546,620790,924013,1419119,2164576,3245421,4996268,7519735,11439869,17483686},{2,2,2,4,8,15,15,22,44,63,100,141,209,329,481,806,1180,1644,2691,4076,6199,9342,13792,21908,32527,49283,76559,112788,174155,264821,399641,614110,916291,1407651,2146424,3220619,4948291,7464530,11345394,17319228},{2,2,2,4,8,14,14,22,44,62,96,138,206,322,478,786,1156,1624,2644,4022,6068,9160,13596,21476,32036,48424,75050,111068,170966,260366,392778,602340,901792,1382428,2108434,3167044,4856826,7339494,11146980,17010414},{2,2,2,4,8,15,15,22,44,63,102,139,206,344,501,812,1164,1666,2790,4142,6250,9468,14015,22355,33077,50005,77649,114354,177597,269357,404947,623988,931074,1431579,2180569,3268970,5031230,7580241,11527205,17607737},{2,2,2,4,8,12,15,25,38,52,93,132,184,293,462,747,1004,1521,2527,3677,5593,8460,12819,19885,29402,45571,69289,102546,159838,241305,365009,557329,837810,1290314,1946319,2943573,4519116,6796902,10367931,15772298},{2,2,3,6,8,15,22,27,42,71,116,151,213,383,590,837,1253,1913,3014,4508,6788,10490,15485,23960,36837,54958,83850,126544,194245,295625,443069,680450,1030127,1560332,2384477,3601747,5489225,8324710,12623483,19276808},{2,2,3,6,8,14,20,27,41,62,111,162,214,364,557,833,1247,1831,2969,4401,6597,10351,15138,23436,35771,53635,82770,123095,189442,289852,432288,666529,1005416,1525317,2334417,3510358,5377090,8140916,12319008,18866108},{2,2,3,6,8,13,18,27,48,67,106,149,217,385,556,820,1228,1841,3024,4412,6563,10248,15131,23733,35773,53362,82752,123199,190274,289667,431789,667413,1004328,1528955,2337134,3506830,5382060,8141092,12335746,18880835},{2,2,3,6,8,12,16,27,49,62,101,152,218,378,531,809,1223,1805,3009,4313,6420,10168,14938,23437,35016,52462,82118,121055,187366,285636,424614,659010,988369,1506920,2304471,3447271,5312250,8021389,12142709,18617914},{2,2,2,4,8,16,16,22,44,64,99,137,212,346,485,802,1183,1662,2728,4107,6269,9417,13892,22244,32906,49615,77214,113981,176322,267295,403103,621009,925017,1422170,2168981,3251033,4998963,7537113,11463714,17499364},{2,2,2,4,8,16,16,22,44,64,108,138,206,366,512,820,1186,1725,2899,4164,6409,9805,14269,22988,33874,51262,79772,116796,182985,275877,413715,642438,953295,1468270,2236711,3347347,5170672,7760482,11820094,18081009},{2,2,2,4,8,16,16,22,44,64,106,142,209,351,504,832,1188,1686,2837,4196,6381,9650,14211,22787,33568,50864,79158,116074,180786,273812,411810,635758,945573,1456802,2218559,3322545,5122695,7705277,11725619,17916551},{2,2,2,4,8,15,15,22,44,63,102,139,206,344,501,812,1164,1666,2790,4142,6250,9468,14015,22355,33077,50005,77649,114354,177597,269357,404947,623988,931074,1431579,2180569,3268970,5031230,7580241,11527205,17607737},{2,2,2,4,8,16,16,22,44,64,108,140,206,366,524,838,1172,1708,2936,4262,6432,9776,14434,23234,34118,51586,80248,117640,184228,278348,417116,645636,960356,1480730,2252704,3370896,5205634,7820988,11907430,18205060}};//10174278, 15458147, 14777945, 14761601, 14316637, 12678459, 13464170, 13273744, 12835708, 13675794, 16844046, 20348556, 19937856, 19952583, 19689662, 18571112, 19152757, 18988299, 18679485, 19276808 [16433346, 19937856, 19527156, 19541883, 19278962, 18160412, 18742057, 18577599, 18268785, 18866108, 16448073, 19952583, 19541883, 19556610, 19293689, 18175139, 18756784, 18592326, 18283512, 18880835, 16185152, 19689662, 19278962, 19293689, 19030768, 17912218, 18493863, 18329405, 18020591, 18617914, 15066602, 18571112, 18160412, 18175139, 17912218, 16793668, 17375313, 17210855, 16902041, 17499364, 15648247, 19152757, 18742057, 18756784, 18493863, 17375313, 17956958, 17792500, 17483686, 18081009, 15483789, 18988299, 18577599, 18592326, 18329405, 17210855, 17792500, 17628042, 17319228, 17916551, 15174975, 18679485, 18268785, 18283512, 18020591, 16902041, 17483686, 17319228, 17010414, 17607737, 15772298, 19276808, 18866108, 18880835, 18617914, 17499364, 18081009, 17916551, 17607737, 18205060
       
        long count = 0;
        int dist = 75;
        
        stones = new ArrayList<Long>();
        for (long i : input) {
            stones.add(i);
        }
        for (int r = 0; r < dist; r++) {
            List<Long> newStones = new ArrayList<>();

            for (long stone : stones) {
            	if(stone < 100 && r > (dist-40)) {
            		count+=precompute[(int) stone][(dist-r-1)];
            		//System.out.println("stone val="+stone+", precompute val="+precompute[(int) stone][(75-r)]+", r="+r);
            		continue;
            	}
                if (stone == 0) {
                    newStones.add(1L);
                } else if (String.valueOf(stone).length() % 2 == 0) {
                    long temp1 = Long.parseLong(String.valueOf(stone).substring(0, String.valueOf(stone).length() / 2));
                    long temp2 = Long.parseLong(String.valueOf(stone).substring(String.valueOf(stone).length() / 2));
                    newStones.add(temp2);
                    newStones.add(temp1);
                } else {
                    newStones.add(2024 * stone);
                }
            }
            stones = newStones;
            System.out.println("Iteration " + (r + 1) + ": " + stones.size());
            //precompute[k][r] = stones.size();
        }
        System.out.println(count+stones.size());
        
//        // generate the precompute array
//        for(int k = 0; k < 100; k++) {
//        	stones = new ArrayList<Long>();
//        	stones.add((long) k);
//	        for (int r = 0; r < 40; r++) {
//	            List<Long> newStones = new ArrayList<>();
//	
//	            for (long stone : stones) {
//	                if (stone == 0) {
//	                    newStones.add(1L);
//	                } else if (String.valueOf(stone).length() % 2 == 0) {
//	                    long temp1 = Long.parseLong(String.valueOf(stone).substring(0, String.valueOf(stone).length() / 2));
//	                    long temp2 = Long.parseLong(String.valueOf(stone).substring(String.valueOf(stone).length() / 2));
//	                    newStones.add(temp2);
//	                    newStones.add(temp1);
//	                } else {
//	                    newStones.add(2024 * stone);
//	                }
//	            }
//	            stones = newStones;
//	            //System.out.println("Iteration " + (r + 1) + ": " + stones.size());
//	            precompute[k][r] = stones.size();
//	        }
//	        //precompute.add((long) stones.size());
//	        System.out.println(k);
//        }
//        
//        try (PrintStream out = new PrintStream(new FileOutputStream("C:\\Users\\gener\\Documents\\programming projects\\adventofcode\\adventofcode\\src\\adventofcodetwentytwentyfour\\precompute.txt"))) {
//            out.print("{{");
//        	for(long[] i:precompute) {
//            	for(long j:i) {
//                	out.print(j);
//                	if(j != i[i.length-1]) {
//                		out.print(",");
//                	}
//            	}
//            	if(i != precompute[precompute.length-1]) {
//            		out.print("},{");
//            	}
//            	else {
//            		out.print("}}");
//            	}
//            }
//        	//out.print(precompute);
//            out.close();
//        } catch (FileNotFoundException e) {
//			// TODO Auto-generated catch block
//			e.printStackTrace();
//		}
        
    	
        
    }
}
